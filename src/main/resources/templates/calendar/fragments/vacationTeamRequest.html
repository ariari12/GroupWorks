<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div class="d-flex justify-content-center align-items-stretch" th:fragment="vacationTeamRequest">
    <div class="card mb-4 w-100 ">
        <div class="card-header">
            <i class="fas fa-table me-1"></i>
            Ìú¥Í∞Ä Ïã†Ï≤≠ ÎÇ¥Ïó≠
            <span class="input-group justify-content-end" style="width: 30%; float: right">
                <input type="text" class="form-control" id="searchKeyword" placeholder="ÏÇ¨ÏõêÏùò Ïù¥Î¶Ñ Í≤ÄÏÉâ" style="width: 60%;">
            </span>
        </div>
        <div class="card-body">
            <table id="vacationTeamRequest" class="table table-hover" style="width:100%">
                <thead>
                <tr>
                    <th>üë§ Ïù¥Î¶Ñ</th>
                    <th>üÜî ÏÇ¨Î≤à</th>
                    <th>üè∑Ô∏è ÏßÅÏ±Ö</th>
                    <th>‚≠ê ÏßÅÍ∏â</th>
                    <th>‚è≥ ÏÇ¨Ïö© Í∏∞Í∞Ñ</th>
                    <th>üóÇÔ∏è Ï¢ÖÎ•ò</th>
                    <th>üìë Ï¶ùÎ™ÖÏûêÎ£å</th>
                    <th>‚úÖ ÏäπÏù∏</th>
                </tr>
                </thead>

                <tbody>
                <th:block th:if="${#lists.isEmpty(vacationRequestList)}">
                    <tr>
                        <td style="text-align: center">Ïã†Ï≤≠ ÎÇ¥Ïó≠ ÏóÜÏùå</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </th:block>

                <th:block th:if="${!#lists.isEmpty(vacationRequestList)}">
                    <tr th:each="dto : ${vacationRequestList}" th:data-id="${dto.calendarId}" class="vacation-row">
                        <td th:text="${dto.name}">ÏÇ¨Ïõê Ïù¥Î¶Ñ</td>
                        <td th:text="${dto.employeeId}">ÏÇ¨Ïõê Î≤àÌò∏</td>
                        <td th:text="${dto.role.name}">ÏÇ¨Ïõê ÏßÅÏ±Ö</td>
                        <td th:text="${dto.rankName}">ÏÇ¨Ïõê ÏßÅÍ∏â</td>
                        <td class="w-25" th:text="|${dto.startDate} ~ ${dto.endDate}|">ÏÇ¨Ïö© Í∏∞Í∞Ñ</td>
                        <td th:text="${dto.vacationType.description}">Ï¢ÖÎ•ò</td>
                        <td th:text="${dto.fileList.size() > 0 ? 'Ï≤®Î∂Ä ÌååÏùº ÏûàÏùå' : 'Ï≤®Î∂Ä ÌååÏùº ÏóÜÏùå'}">Ï¶ùÎ™ÖÏûêÎ£å</td>
                        <td th:text="${dto.status.description}">ÏäπÏù∏</td>
                    </tr>
                </th:block>
                </tbody>
            </table>
            <div th:if="${vacationRequestList.totalPages > 0}">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center">
                        <!-- Previous Page Link -->
                        <li class="page-item" th:classappend="${vacationRequestList.number == 0 || vacationRequestList.totalPages == 0} ? 'disabled'">
                            <a class="page-link" th:href="@{|?page=${vacationRequestList.number - 1 > 0 ? vacationRequestList.number - 1 : 0}|}" aria-label="Previous" th:attr="aria-disabled=${vacationRequestList.number == 0}">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>
                        <!-- First Page Link -->
                        <li class="page-item" th:if="${vacationRequestList.totalPages > 1 && vacationRequestList.number > 3}">
                            <a class="page-link" th:href="@{|?page=0|}">1</a>
                        </li>
                        <li class="page-item disabled" th:if="${vacationRequestList.number > 3}">
                            <span class="page-link">...</span>
                        </li>

                        <!-- Page Numbers -->
                        <li class="page-item" th:each="i : ${#numbers.sequence(vacationRequestList.number - 2 < 0 ? 0 : vacationRequestList.number - 2, vacationRequestList.number + 2 >= vacationRequestList.totalPages ? vacationRequestList.totalPages - 1 : vacationRequestList.number + 2)}" th:classappend="${i == vacationRequestList.number} ? 'active'">
                            <a class="page-link" th:href="@{|?page=${i}|}" th:text="${i + 1}">1</a>
                        </li>

                        <!-- Last Page Link -->
                        <li class="page-item disabled" th:if="${vacationRequestList.number < vacationRequestList.totalPages - 4}">
                            <span class="page-link">...</span>
                        </li>
                        <li class="page-item" th:if="${vacationRequestList.totalPages > 1 && vacationRequestList.number < vacationRequestList.totalPages - 3}">
                            <a class="page-link" th:href="@{|?page=${vacationRequestList.totalPages - 1}|}" th:text="${vacationRequestList.totalPages}">Last</a>
                        </li>

                        <!-- Next Page Link -->
                        <li class="page-item" th:classappend="${vacationRequestList.number + 1 == vacationRequestList.totalPages || vacationRequestList.totalPages == 0} ? 'disabled'">
                            <a class="page-link" th:href="@{|?page=${vacationRequestList.number + 1}|}" aria-label="Next" th:attr="aria-disabled=${vacationRequestList.number + 1 == vacationRequestList.totalPages}">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Handling when there's no data -->
            <div th:if="${vacationRequestList.totalPages == 0}">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center">
                        <li class="page-item active">
                            <a class="page-link" th:href="@{|?page=0|}">1</a>
                        </li>
                    </ul>
                </nav>
            </div>
            <div id="modalContainer"></div>

            <script>
                $(document).ready(function () {
                    $('.vacation-row').on('click', function () {
                        const id = $(this).data('id');
                        $.get('team/detail', {id: id}, function (data) {
                            $('#modalContainer').html(data);
                            $('#vacationModal').modal('show');
                        });
                    });
                    $('#searchKeyword').keypress(function (e) {
                        if (e.keyCode == 13) {
                            let keyword = $('#searchKeyword').val();
                            location.href="./team?search=" + keyword;
                        }
                    })
                });
            </script>
        </div>
    </div>
</div>
